<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>SAGA GIS WaTEM module &mdash; saga_watem unknown documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=fa44fd50" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=19f00094" />
      <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
      <link rel="stylesheet" type="text/css" href="_static/custom.css" />

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="_static/jquery.js?v=5d32c60e"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="_static/documentation_options.js?v=3f1b9271"></script>
        <script src="_static/doctools.js?v=888ff710"></script>
        <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
        <script src="_static/clipboard.min.js?v=a7894cd8"></script>
        <script src="_static/copybutton.js?v=f281be69"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Model description" href="description.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="#" class="icon icon-home">
            saga_watem
          </a>
              <div class="version">
                unknown
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">User guide</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="description.html">Model description</a></li>
<li class="toctree-l1"><a class="reference internal" href="gettingstarted.html">Getting started</a></li>
<li class="toctree-l1"><a class="reference internal" href="flanders-tool.html">Flanders application</a></li>
<li class="toctree-l1"><a class="reference internal" href="topology.html">Topology</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Module Reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="overview_watem.html">WaTEM</a></li>
<li class="toctree-l1"><a class="reference internal" href="overview_watem_flanders.html">WaTEM Flanders</a></li>
<li class="toctree-l1"><a class="reference internal" href="overview_topology.html">Topology</a></li>
<li class="toctree-l1"><a class="reference internal" href="overview_line_direction.html">Line direction</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Developer Guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="authors.html">Authors</a></li>
<li class="toctree-l1"><a class="reference internal" href="changelog.html">Changelog</a></li>
<li class="toctree-l1"><a class="reference internal" href="license.html">License</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="#">saga_watem</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="#" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">SAGA GIS WaTEM module</li>
      <li class="wy-breadcrumbs-aside">
              <a href="https://github.com/DOV-Vlaanderen/saga-watem/blob/main/docsindex.md" class="fa fa-github"> Edit on GitHub</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section class="tex2jax_ignore mathjax_ignore" id="saga-gis-watem-module">
<h1>SAGA GIS WaTEM module<a class="headerlink" href="#saga-gis-watem-module" title="Link to this heading">¶</a></h1>
<p>This repository contains a <a class="reference external" href="https://saga-gis.org">SAGA-GIS</a> translation of the <a class="reference external" href="https://watem-sedem.github.io/">WaTEM erosion model</a>. It also contains modules that can be used in preprocessing and postprocessing the result of that program.</p>
<p>More details on the modules can be found in:</p>
<ul class="simple">
<li><p><a class="reference internal" href="gettingstarted.html"><span class="std std-doc">Getting started</span></a></p></li>
<li><p><a class="reference internal" href="flanders-tool.html"><span class="std std-doc">Application to Flanders</span></a></p></li>
<li><p><a class="reference internal" href="topology.html"><span class="std std-doc">Topology</span></a></p></li>
</ul>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="installing-saga">
<h1>Installing SAGA<a class="headerlink" href="#installing-saga" title="Link to this heading">¶</a></h1>
<section id="on-windows">
<h2>On windows<a class="headerlink" href="#on-windows" title="Link to this heading">¶</a></h2>
<p>On windows, download version SAGA 8.5.1 from the website, a direct link to the file is here <a class="reference external" href="https://sourceforge.net/projects/saga-gis/files/SAGA%20-%208/SAGA%20-%208.5.1/saga-8.5.1_x64.zip/download">saga-8.5.1_x64.zip</a>. Alternatively, you can use SAGA 9.2.0 from the same website. Other versions have not been tested.</p>
<p>Get the windows built dll files from the releases page and copy these dll files into the tools subfolder of saga and restart. You can also drag and drop the dll on saga if they are stored in a different location.</p>
<p>If you want to test unreleased version of SAGA, go to the github action page for <a class="reference external" href="https://github.com/DOV-Vlaanderen/saga-watem/actions/workflows/cmake-windows.yml">windows builds</a>. You can find snapshots of the dll here.</p>
</section>
<section id="on-linux">
<h2>On linux<a class="headerlink" href="#on-linux" title="Link to this heading">¶</a></h2>
<p>Packages are built for Debian Linux (Bullseye) and Ubuntu LTS (Focal). The pacakges can be grabbed from the release page.</p>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="building-saga">
<h1>Building saga<a class="headerlink" href="#building-saga" title="Link to this heading">¶</a></h1>
<section id="id1">
<h2>On windows<a class="headerlink" href="#id1" title="Link to this heading">¶</a></h2>
<p>Download SAGA (compiled version, 8.5.1 using the link above) and create an environmental variable <code class="docutils literal notranslate"><span class="pre">SAGA</span></code> containing the path where saga was installed/unzipped. Install Visual Studio or Visual studio build tools and cmake and create the solution file using cmake:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mkdir</span> <span class="n">build</span>
<span class="n">cmake</span> <span class="o">..</span>
</pre></div>
</div>
<p>This will create a solution that can be opened with visual studio, or can be built using msbuild.</p>
</section>
<section id="on-debian-ubuntu-linux">
<h2>On debian/ubuntu linux:<a class="headerlink" href="#on-debian-ubuntu-linux" title="Link to this heading">¶</a></h2>
<p>Make sure you have build-essential, cmake and libsaga-dev installed</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="n">apt</span> <span class="n">install</span> <span class="n">build</span><span class="o">-</span><span class="n">essential</span> <span class="n">cmake</span> <span class="n">libsaga</span><span class="o">-</span><span class="n">dev</span>
</pre></div>
</div>
<p>Next, build and install from source:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">rm</span> <span class="o">-</span><span class="n">rf</span> <span class="n">build</span>
<span class="n">mkdir</span> <span class="n">build</span>
<span class="n">cd</span> <span class="n">build</span>
<span class="n">cmake</span> <span class="o">..</span>
<span class="n">make</span>
<span class="n">make</span> <span class="n">DESTDIR</span><span class="o">=</span><span class="n">libs</span> <span class="n">install</span>
<span class="n">cd</span> <span class="o">..</span>
</pre></div>
</div>
<p>To build the documentation do (make sure you have dependencies in ci/requirements.txt) installed:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cd</span> <span class="n">docs</span>
<span class="n">mkdir</span> <span class="n">tool_html</span>
<span class="n">SAGA_TLB</span><span class="o">=../</span><span class="n">build</span><span class="o">/</span><span class="n">libs</span><span class="o">/</span><span class="n">saga</span> <span class="n">saga_cmd</span> <span class="o">--</span><span class="n">create</span><span class="o">-</span><span class="n">docs</span><span class="o">=</span><span class="n">tool_html</span>
<span class="n">make</span> <span class="n">html</span>
</pre></div>
</div>
</section>
<section id="running-automated-tests">
<h2>Running automated tests<a class="headerlink" href="#running-automated-tests" title="Link to this heading">¶</a></h2>
<p>A few automated tests are written in python. To run these under linux, run the compilation as mentioned above.</p>
<p>Next install the dependencies either in an environment or as apt packages and run</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="n">apt</span> <span class="n">install</span> <span class="n">python</span><span class="o">-</span><span class="n">pytest</span> <span class="n">python</span><span class="o">-</span><span class="n">rasterio</span> <span class="n">python</span><span class="o">-</span><span class="n">geopandas</span>
<span class="n">pytest</span><span class="o">-</span><span class="mi">3</span>
</pre></div>
</div>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="legacy">
<h1>Legacy<a class="headerlink" href="#legacy" title="Link to this heading">¶</a></h1>
<p>The saga-watem module is a derivative product of the code that was devoloped
for the ‘erosiekaart’ for Flanders (see below). The tool was developed
in 2016 (in Dutch), and was fully documented and refactored in 2024 by Fluves.</p>
<p>Consequently, the current tooling is structured in a different way compared
to the initial tool. As of now, it consists of two tools (watem and
watem-flanders) to make a clear distinction between tools relevant for
computing the gross erosion (core) and tools relevant for preprocessing data from
Flanders as input for the core tool.</p>
<p>The tool is now structured as follows:</p>
<p>in 2016 (in Dutch), and was fully documented and refactored in 2024 with a</p>
<ul class="simple">
<li><p>watem:</p>
<ol class="arabic simple">
<li><p>Calculate uparea (used to be module 3.1)</p></li>
<li><p>LS-calculations (used to be module 3.2)</p></li>
<li><p>Watererosion based on LS (RUSLE) (used to be module 3.4)</p></li>
<li><p>Tillage erosion calculations (used to be module 3.5)</p></li>
</ol>
</li>
<li><p>watem-flanders:</p>
<ol class="arabic simple">
<li><p>Prepare parcel map (used to be module 1)</p></li>
<li><p>3x3 filter within parcel boundaries (used to be module 2)</p></li>
<li><p>C calculation based on parcel grid (used to be module 3.3)</p></li>
<li><p>C calculations shape attribute (module 3.6)</p></li>
<li><p>Compute Calculations Erosion map (combines all steps) (used to be 2.5)</p></li>
</ol>
</li>
</ul>
<section id="contents">
<h2>Contents<a class="headerlink" href="#contents" title="Link to this heading">¶</a></h2>
<div class="toctree-wrapper compound">
<p class="caption" role="heading"><span class="caption-text">User guide</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="description.html">Model description</a><ul>
<li class="toctree-l2"><a class="reference internal" href="description.html#ls-factor">LS-factor</a><ul>
<li class="toctree-l3"><a class="reference internal" href="description.html#desmet-govers-1996">Desmet &amp; Govers (1996):</a></li>
<li class="toctree-l3"><a class="reference internal" href="description.html#van-oost-2003">Van Oost, 2003</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="description.html#upslope-area">Upslope area</a></li>
<li class="toctree-l2"><a class="reference internal" href="description.html#tillage-erosion">Tillage erosion</a></li>
<li class="toctree-l2"><a class="reference internal" href="description.html#references">References</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="gettingstarted.html">Getting started</a><ul>
<li class="toctree-l2"><a class="reference internal" href="gettingstarted.html#the-watem-module">The WaTEM module</a></li>
<li class="toctree-l2"><a class="reference internal" href="gettingstarted.html#compute-water-erosion">Compute water erosion</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="flanders-tool.html">Flanders application</a><ul>
<li class="toctree-l2"><a class="reference internal" href="flanders-tool.html#landuse-map">Landuse map</a></li>
<li class="toctree-l2"><a class="reference internal" href="flanders-tool.html#parcels-map">Parcels map</a></li>
<li class="toctree-l2"><a class="reference internal" href="flanders-tool.html#digital-elevation-model">Digital elevation model</a></li>
<li class="toctree-l2"><a class="reference internal" href="flanders-tool.html#c-grid">C-grid</a></li>
<li class="toctree-l2"><a class="reference internal" href="flanders-tool.html#k-grid">K-grid</a></li>
<li class="toctree-l2"><a class="reference internal" href="flanders-tool.html#postprocessing">Postprocessing</a></li>
<li class="toctree-l2"><a class="reference internal" href="flanders-tool.html#run-in-command-line">Run in command line</a></li>
<li class="toctree-l2"><a class="reference internal" href="flanders-tool.html#complete-tool">Complete tool</a></li>
<li class="toctree-l2"><a class="reference internal" href="flanders-tool.html#example-script-for-flanders">Example script for Flanders</a></li>
<li class="toctree-l2"><a class="reference internal" href="flanders-tool.html#extra-information">Extra information</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="topology.html">Topology</a><ul>
<li class="toctree-l2"><a class="reference internal" href="topology.html#topology">Topology</a></li>
<li class="toctree-l2"><a class="reference internal" href="topology.html#upstream-edges">Upstream edges</a></li>
<li class="toctree-l2"><a class="reference internal" href="topology.html#shreve-order-and-sort-order">Shreve order and Sort order</a><ul>
<li class="toctree-l3"><a class="reference internal" href="topology.html#special-cases">Special cases</a></li>
<li class="toctree-l3"><a class="reference internal" href="topology.html#split-paths">Split paths</a></li>
<li class="toctree-l3"><a class="reference internal" href="topology.html#circular-routes">Circular routes</a></li>
<li class="toctree-l3"><a class="reference internal" href="topology.html#complete-circle">Complete circle</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<div class="toctree-wrapper compound">
<p class="caption" role="heading"><span class="caption-text">Module Reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="overview_watem.html">WaTEM</a><ul>
<li class="toctree-l2"><a class="reference internal" href="overview_watem.html#calculate-uparea">[1] Calculate uparea</a></li>
<li class="toctree-l2"><a class="reference internal" href="overview_watem.html#ls-calculation">[2] LS calculation</a></li>
<li class="toctree-l2"><a class="reference internal" href="overview_watem.html#watererosion-based-on-ls-rusle">[3] Watererosion based on LS (RUSLE)</a></li>
<li class="toctree-l2"><a class="reference internal" href="overview_watem.html#tillage-erosion-calculation">[4] Tillage erosion calculation</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="overview_watem_flanders.html">WaTEM Flanders</a><ul>
<li class="toctree-l2"><a class="reference internal" href="overview_watem_flanders.html#prepare-parcel-map">[1] Prepare parcel Map</a></li>
<li class="toctree-l2"><a class="reference internal" href="overview_watem_flanders.html#x3-filter-within-parcel-boundaries">[2] 3x3 filter within parcel boundaries</a></li>
<li class="toctree-l2"><a class="reference internal" href="overview_watem_flanders.html#c-calculation-based-on-parcel-grid">[3] C calculation based on parcel grid</a></li>
<li class="toctree-l2"><a class="reference internal" href="overview_watem_flanders.html#c-calculation-shape-attribute">[4] C calculation shape attribute</a></li>
<li class="toctree-l2"><a class="reference internal" href="overview_watem_flanders.html#complete-calculation-erosion-map-combines-all-steps-see-submodules-for-more-information">[5] Complete Calculation Erosion map (combines all steps). See submodules for more information.</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="overview_topology.html">Topology</a><ul>
<li class="toctree-l2"><a class="reference internal" href="overview_topology.html#topologize-polylines">[0] Topologize Polylines</a></li>
<li class="toctree-l2"><a class="reference internal" href="overview_topology.html#upstream-edges">[1] Upstream Edges</a></li>
<li class="toctree-l2"><a class="reference internal" href="overview_topology.html#routing-to-shape">[2] Routing to shape</a></li>
<li class="toctree-l2"><a class="reference internal" href="overview_topology.html#segment-to-subcatchments">[3] Segment to subcatchments</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="overview_line_direction.html">Line direction</a><ul>
<li class="toctree-l2"><a class="reference internal" href="overview_line_direction.html#line-direction">[0] Line Direction</a></li>
</ul>
</li>
</ul>
</div>
<div class="toctree-wrapper compound">
<p class="caption" role="heading"><span class="caption-text">Developer Guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="authors.html">Authors</a></li>
<li class="toctree-l1"><a class="reference internal" href="changelog.html">Changelog</a></li>
<li class="toctree-l1"><a class="reference internal" href="license.html">License</a></li>
</ul>
</div>
</section>
<section id="indices-and-tables">
<h2>Indices and tables<a class="headerlink" href="#indices-and-tables" title="Link to this heading">¶</a></h2>
<ul class="simple">
<li><p><a class="reference internal" href="genindex.html"><span class="std std-ref">Index</span></a></p></li>
<li><p><a class="reference internal" href="py-modindex.html"><span class="std std-ref">Module Index</span></a></p></li>
<li><p><a class="reference internal" href="search.html"><span class="std std-ref">Search Page</span></a></p></li>
</ul>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="description.html" class="btn btn-neutral float-right" title="Model description" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2017-2024 Johan Van de Wauw.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>